{"version":3,"sources":["controller/search-controller.es6"],"names":[],"mappings":"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","file":"controller/search-controller.js","sourcesContent":["class SearchController {\n\tconstructor ($rootScope, $timeout, svgIcon, $location, defaultDistance, maxDistance, languageSettings, ActivitiesService, LanguageService, DataService, AlertService, PositionService) {\n\t\t//local\n\t\tthis.canvas = document.createElement('canvas');\n\t\tthis.context = this.canvas.getContext('2d');\n\t\tthis.height = window.innerHeight - 110; //for global_alerts & slider & footer\n\t\tthis.width = window.innerWidth;\n\t\tthis.centerY = parseInt((this.height / 2), 10);\n\t\tthis.centerX = parseInt((this.width / 2), 10);\n\t\tthis.svg = svgIcon;\n\t\tthis.svgWidth = 25;\n\t\t// DI\n\t\tthis.$rootScope = $rootScope;\n\t\tthis.$timeout = $timeout;\n\t\tthis.$location = $location;\n\t\tthis.languageSettings = languageSettings;\n\t\tthis.ActivitiesService = ActivitiesService;\n\t\tthis.LanguageService = LanguageService;\n\t\tthis.selectedDistance = defaultDistance;\n\t\tthis.lastSelectedDistance = defaultDistance;\n\t\tthis.maxDistance = maxDistance;\n\t\tthis.AlertService = AlertService;\n\t\tthis.PositionService = PositionService;\n\t\tthis.$rootScope.$broadcast('show-alert');\n\t\tthis.searchResults = {};\n\t\tthis.tandemData = {};\n\t\tthis.drawRadar();\n\t\tif (!this.PositionService.chosenPosition.latitude || !this.PositionService.chosenPosition.longitude) {\n\t\t\tthis.AlertService.alerts.retrieving_searchresults = false;\n\t\t\tthis.$location.path('/');\n\t\t} else if (\n\t\t\t(parseInt(localStorage.getItem('tandemApp_lastSearch_offerId')) === parseInt(localStorage.getItem('tandemApp_activities_offerId'))) &&\n\t\t\t(parseInt(localStorage.getItem('tandemApp_lastSearch_searchId')) === parseInt(localStorage.getItem('tandemApp_activities_searchId'))) &&\n\t\t\t(this.PositionService.chosenPosition.longitude.toString() === localStorage.getItem('tandemApp_lastSearch_longitude')) &&\n\t\t\t(this.PositionService.chosenPosition.latitude.toString() === localStorage.getItem('tandemApp_lastSearch_latitude')) &&\n\t\t\t(localStorage.getItem('tandemApp_lastSearch_results')) // actually have the result\n\t\t) {\n\t\t\tthis.searchResults = JSON.parse(localStorage.getItem('tandemApp_lastSearch_results'));\n\t\t\tthis.drawUsers();\n\t\t} else {\n\t\t\tthis.AlertService.alerts.retrieving_searchresults = true;\n\t\t\tDataService.getResults().then((data) => {\n\t\t\t\tthis.AlertService.alerts.retrieving_searchresults = false;\n\t\t\t\tthis.$rootScope.$broadcast('show-alert');\n\t\t\t\tif (data && data.data.length > 0) {\n\t\t\t\t\tlet randomize = this.randomizeResults();\n\t\t\t\t\tthis.searchResults = randomize(data.data);\n\t\t\t\t\tlocalStorage.setItem('tandemApp_lastSearch_offerId', this.ActivitiesService.offerObj.id);\n\t\t\t\t\tlocalStorage.setItem('tandemApp_lastSearch_searchId', this.ActivitiesService.searchObj.id);\n\t\t\t\t\tlocalStorage.setItem('tandemApp_lastSearch_latitude', this.PositionService.chosenPosition.latitude);\n\t\t\t\t\tlocalStorage.setItem('tandemApp_lastSearch_longitude', this.PositionService.chosenPosition.longitude);\n\t\t\t\t\tlocalStorage.setItem('tandemApp_lastSearch_results', JSON.stringify(this.searchResults));\n\t\t\t\t\tthis.drawUsers();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\tchangeDistance () {\n\t\t/*\n\t\t * wait 2 seconds to see if the user actually changed the distance\n\t\t */\n\t\tthis.$timeout(() => {\n\t\t\tif (this.lastSelectedDistance !== this.selectedDistance) {\n\t\t\t\tthis.drawRadar();\n\t\t\t\tthis.drawUsers();\n\t\t\t\tthis.lastSelectedDistance = this.selectedDistance;\n\t\t\t}\n\t\t}, 2000);\n\t}\n\tgetOffset (selectDistance, resultDistance) {\n\t\tlet x = Math.random() * (this.width - 2),\n\t\t\ty = Math.random() * (this.height - 2),\n\t\t\tx2 = x / 2,\n\t\t\ty2 = y / 2,\n\t\t\tquote = resultDistance / selectDistance;\n\t\treturn [x2 * quote, y2 * quote];\n\t}\n\tdrawImage (id, x, y) {\n\t\tlet mySvg,\n\t\t\tmySrc,\n\t\t\tsource;\n\t\tmySvg = this.svg;\n\t\tmySrc = 'data:image/svg+xml;base64,' + window.btoa(mySvg);\n\t\tsource = new Image();\n\t\tsource.id = 'user_' + id;\n\t\tsource.src = mySrc;\n\t\tsource.onload = () => {\n\t\t\tthis.context.globalAlpha = 0.8;\n\t\t\tthis.context.drawImage(source, x, y, this.svgWidth, this.svgWidth);\n\t\t\tthis.context.restore();\n\t\t};\n\t\treturn source;\n\t}\n\trandomizeResults () {\n\t\treturn (data) => {\n\t\t\tvar resultArray = [];\n\t\t\tfor (let resultArrayCounter = 0; resultArrayCounter < data.length; resultArrayCounter++) {\n\t\t\t\tlet percentX = 0,\n\t\t\t\t\tpercentY = 0,\n\t\t\t\t\toffset = this.getOffset(this.maxDistance, data[resultArrayCounter].distance, resultArrayCounter),\n\t\t\t\t\toffsetX = offset[0],\n\t\t\t\t\toffsetY = offset[1],\n\t\t\t\t\trandomDirection = parseInt(Math.random() * 4 + 1, 10);\n\n\t\t\t\tpercentX = (offsetX / (this.width / 2)) * 100;\n\t\t\t\tpercentY = (offsetY / (this.height / 2)) * 100;\n\t\t\t\tdata[resultArrayCounter].percentX = percentX;\n\t\t\t\tdata[resultArrayCounter].percentY = percentY;\n\t\t\t\tdata[resultArrayCounter].randomDirection = randomDirection;\n\t\t\t\tresultArray.push(data[resultArrayCounter]);\n\t\t\t}\n\t\t\treturn resultArray;\n\t\t};\n\t}\n\tdrawRadar () {\n\t\tif (document.getElementById('forRadar')) {\n\t\t\t/*\n\t\t\t * delete existing canvases\n\t\t\t */\n\t\t\tdocument.getElementById('forRadar').innerHTML = '';\n\n\t\t\tif (document.getElementById('forRadar').children.length > 0) {\n\t\t\t\tdocument.getElementById('forRadar').children[0].remove();\n\t\t\t}\n\n\t\t\tlet radius = 10,\n\t\t\t\tradarRingCounter = 0,\n\t\t\t\tminRadiusFor5Rings = parseInt(this.width, 10) / 1.2 / 5;\n\n\t\t\tthis.canvas.setAttribute('width', this.width);\n\t\t\tthis.canvas.setAttribute('height', this.height);\n\t\t\tthis.canvas.setAttribute('style', 'position: absolute; x:0; y:0;');\n\n\t\t\tdocument.getElementById('forRadar').appendChild(this.canvas);\n\n\t\t\tthis.context.clearRect(0, 0, this.width, this.height);\n\n\t\t\tthis.context.beginPath();\n\t\t\tthis.context.arc(this.centerX, this.centerY, radius, 0, 2 * Math.PI, false);\n\t\t\tthis.context.fillStyle = '#000';\n\t\t\tthis.context.fill();\n\t\t\tthis.context.stroke();\n\n\t\t\tfor (radarRingCounter = 0; radarRingCounter < 5; radarRingCounter++) {\n\t\t\t\tthis.context.beginPath();\n\t\t\t\tthis.context.arc(this.centerX, this.centerY, minRadiusFor5Rings * radarRingCounter, 0, 2 * Math.PI, false);\n\t\t\t\tif (radarRingCounter < 4) {\n\t\t\t\t\tthis.context.fill();\n\t\t\t\t\tthis.context.fillStyle = '#8bc717';\n\t\t\t\t\tthis.context.globalAlpha = parseFloat(radarRingCounter / 10) - 0.1;\n\t\t\t\t}\n\t\t\t\tthis.context.stroke();\n\t\t\t}\n\n\t\t\tthis.canvas.onclick = (e) => {\n\n\t\t\t\tvar thisX = parseInt(e.clientX, 10),\n\t\t\t\t\tthisY = parseInt(e.clientY, 10);\n\n\t\t\t\tangular.forEach(this.searchResults, (result) => {\n\t\t\t\t\t/*\n\t\t\t\t\t * check if any of the people in the array have the coordinates clicked\n\t\t\t\t\t * (+/- 5px as this is the radius)\n\t\t\t\t\t * AND\n\t\t\t\t\t *  --- substract 60 px because of header !!! ---> 0 at the moment\n\t\t\t\t\t * (look above : we substracted 120px from total height)\n\t\t\t\t\t */\n\t\t\t\t\tif (\n\t\t\t\t\t\t((parseInt(result.x) + parseInt(this.svgWidth)) >= thisX && result.x <= thisX) &&\n\t\t\t\t\t\t((parseInt(result.y) + parseInt(this.svgWidth)) >= (thisY - 60) && result.y <= thisY - 60)\n\t\t\t\t\t) {\n\t\t\t\t\t\t//currentProfileIndex=i;\n\t\t\t\t\t\tconsole.log('User ', result);\n\t\t\t\t\t\t//this.$location.path('#tandem/' + result.id);\n\t\t\t\t\t\tthis.$timeout(() => {\n\t\t\t\t\t\t\t//this.$location.path('/iii');\n\t\t\t\t\t\t\t//console.log('this.$location : ', this.$location);\n\t\t\t\t\t\t\tthis.tandemData = result;\n\t\t\t\t\t\t});\n\t\t\t\t\t\t//localStorage.setItem('tandemApp_lastSearch_tandemData', JSON.stringify(result));\n\t\t\t\t\t\t//this.$rootScope.$broadcast('tandem-data-found');\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t};\n\t\t\treturn true;\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t}\n\tdrawUsers () {\n\t\tvar done = false;\n\t\tfor (let resultArrayCounter = 0; resultArrayCounter < this.searchResults.length; resultArrayCounter++) {\n\t\t\tvar newX,\n\t\t\t\tnewY,\n\t\t\t\tforX = ((this.maxDistance / parseInt(this.selectedDistance, 10)) * this.searchResults[resultArrayCounter].percentX),\n\t\t\t\tforY = ((this.maxDistance / parseInt(this.selectedDistance, 10)) * this.searchResults[resultArrayCounter].percentY),\n\t\t\t\toffsetX = forX, // (forX * 100) / (width / 2), //apply the percent to half the width (x)\n\t\t\t\toffsetY = forY, //(forY * 100) / (height / 2), //apply the percent to half the height (x)\n\t\t\t\trandomDirection = this.searchResults[resultArrayCounter].randomDirection;\n\t\t\t/*\n\t\t\t * show only results with 100% or less (if magnified)\n\t\t\t */\n\t\t\tif (parseInt(offsetX / 2, 10) <= 100 && parseInt(offsetY / 2, 10) <= 100) {\n\t\t\t\tswitch (randomDirection) {\n\t\t\t\t\tcase 1:\n\t\t\t\t\t\tnewX = parseInt(this.centerX + offsetX, 10);\n\t\t\t\t\t\tnewY = parseInt(this.centerY + offsetY, 10);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 2:\n\t\t\t\t\t\tnewX = parseInt(this.centerX - offsetX, 10);\n\t\t\t\t\t\tnewY = parseInt(this.centerY - offsetY, 10);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 3:\n\t\t\t\t\t\tnewX = parseInt(this.centerX + offsetX, 10);\n\t\t\t\t\t\tnewY = parseInt(this.centerY - offsetY, 10);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 4:\n\t\t\t\t\t\tnewX = parseInt(this.centerX - offsetX, 10);\n\t\t\t\t\t\tnewY = parseInt(this.centerY + offsetY, 10);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tnewX = parseInt(this.centerX + 0, 10);\n\t\t\t\t\t\tnewY = parseInt(this.centerY + 0, 10);\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\t/*\n\t\t\t\t * -> resultArray.push coordinates\n\t\t\t\t */\n\t\t\t\tthis.searchResults[resultArrayCounter].x = newX;\n\t\t\t\tthis.searchResults[resultArrayCounter].y = newY;\n\t\t\t\tthis.drawImage(this.searchResults[resultArrayCounter].tandem_id, this.searchResults[resultArrayCounter].x, this.searchResults[resultArrayCounter].y);\n\t\t\t}\n\t\t\tif (parseInt(resultArrayCounter) + 1 === this.searchResults.length) {\n\t\t\t\tdone = true;\n\t\t\t}\n\t\t}\n\t\treturn done;\n\t}\n}\n\nSearchController.$inject = ['$rootScope', '$timeout', 'svgIcon', '$location', 'defaultDistance', 'maxDistance', 'languageSettings', 'ActivitiesService', 'LanguageService', 'DataService', 'AlertService', 'PositionService'];\n\nexport { SearchController };\n"],"sourceRoot":"/source/"}