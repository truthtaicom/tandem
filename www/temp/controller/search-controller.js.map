{"version":3,"sources":["controller/search-controller.es6"],"names":[],"mappings":"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","file":"controller/search-controller.js","sourcesContent":["class SearchController {\n\tconstructor ($rootScope, $timeout, svgIcon, $location, defaultDistance, maxDistance, languageSettings, ActivitiesService, LanguageService, DataService, AlertService, PositionService) {\n\t\t//local\n\t\tthis.canvas = document.createElement('canvas');\n\t\tthis.context = this.canvas.getContext('2d');\n\t\tthis.height = window.innerHeight - 110; //for global_alerts & slider & footer\n\t\tthis.width = window.innerWidth;\n\t\tthis.centerY = parseInt((this.height / 2), 10);\n\t\tthis.centerX = parseInt((this.width / 2), 10);\n\t\tthis.svg = svgIcon;\n\t\tthis.svgWidth = 25;\n\t\t// DI\n\t\tthis.$rootScope = $rootScope;\n\t\tthis.$timeout = $timeout;\n\t\tthis.languageSettings = languageSettings;\n\t\tthis.ActivitiesService = ActivitiesService;\n\t\tthis.LanguageService = LanguageService;\n\t\tthis.selectedDistance = defaultDistance;\n\t\tthis.lastSelectedDistance = defaultDistance;\n\t\tthis.maxDistance = maxDistance;\n\t\tthis.AlertService = AlertService;\n\t\tthis.PositionService = PositionService;\n\t\tthis.$rootScope.$broadcast('show-alert');\n\t\tthis.searchResults = [];\n\t\tthis.drawRadar();\n\t\tif (!this.PositionService.chosenPosition.latitude || !this.PositionService.chosenPosition.longitude) {\n\t\t\tthis.AlertService.alerts.retrieving_searchresults = false;\n\t\t\t$location.path('/');\n\t\t} else if (\n\t\t\t(parseInt(this.ActivitiesService.offerObj.id) === parseInt(localStorage.getItem('tandemApp_activities_offerId'))) &&\n\t\t\t(parseInt(this.ActivitiesService.searchObj.id) === parseInt(localStorage.getItem('tandemApp_activities_searchId'))) &&\n\t\t\t(parseInt(this.maxDistance) === parseInt(localStorage.getItem('tandemApp_lastSearch_maxDistance'))) &&\n\t\t\t(this.PositionService.chosenPosition.longitude.toString() === localStorage.getItem('tandemApp_lastSearch_longitude')) &&\n\t\t\t(this.PositionService.chosenPosition.latitude.toString() === localStorage.getItem('tandemApp_lastSearch_latitude'))\n\t\t) {\n\t\t\tthis.searchResults = JSON.parse(localStorage.getItem('tandemApp_lastSearch_results'));\n\t\t\tthis.drawUsers(true);\n\t\t} else {\n\t\t\tthis.AlertService.alerts.retrieving_searchresults = true;\n\t\t\tDataService.getResults().then((data) => {\n\t\t\t\tlocalStorage.setItem('tandemApp_lastSearch_maxDistance', this.maxDistance);\n\t\t\t\tlocalStorage.setItem('tandemApp_lastSearch_latitude', this.PositionService.chosenPosition.latitude);\n\t\t\t\tlocalStorage.setItem('tandemApp_lastSearch_longitude', this.PositionService.chosenPosition.longitude);\n\t\t\t\tthis.AlertService.alerts.retrieving_searchresults = false;\n\t\t\t\tthis.$rootScope.$broadcast('show-alert');\n\t\t\t\tif (data && data.data.length > 0) {\n\t\t\t\t\tconsole.log('data.data : ', data.data);\n\t\t\t\t\tlet randomize = this.randomizeResults();\n\t\t\t\t\tthis.searchResults = randomize(data.data);\n\t\t\t\t\tlocalStorage.setItem('tandemApp_lastSearch_results', JSON.stringify(this.searchResults));\n\t\t\t\t\tthis.drawUsers();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\tchangeDistance () {\n\t\t/*\n\t\t * wait 2 seconds to see if the user actually changed the distance\n\t\t */\n\t\tthis.$timeout(() => {\n\t\t\tconsole.log('this.lastSelectedDistance : ', this.lastSelectedDistance, ' this.selectedDistance ', this.selectedDistance);\n\t\t\tif (this.lastSelectedDistance !== this.selectedDistance) {\n\t\t\t\tthis.drawRadar();\n\t\t\t\tthis.drawUsers();\n\t\t\t\tthis.lastSelectedDistance = this.selectedDistance;\n\t\t\t}\n\t\t}, 2000);\n\t}\n\tgetOffset (selectDistance, resultDistance) {\n\t\tlet x = Math.random() * (this.width - 2),\n\t\t\ty = Math.random() * (this.height - 2),\n\t\t\tx2 = x / 2,\n\t\t\ty2 = y / 2,\n\t\t\tquote = resultDistance / selectDistance;\n\t\treturn [x2 * quote, y2 * quote];\n\t}\n\tdrawImage (x, y) {\n\t\tlet mySvg,\n\t\t\tmySrc,\n\t\t\tsource;\n\t\tmySvg = this.svg;\n\t\tmySrc = 'data:image/svg+xml;base64,' + window.btoa(mySvg);\n\t\tsource = new Image();\n\t\tsource.src = mySrc;\n\t\tsource.onload = () => {\n\t\t\tthis.context.globalAlpha = 0.8;\n\t\t\tthis.context.drawImage(source, x, y, this.svgWidth, this.svgWidth);\n\t\t\tthis.context.restore();\n\t\t};\n\t\treturn source;\n\t}\n\trandomizeResults () {\n\t\treturn (data) => {\n\t\t\tvar resultArray = [];\n\t\t\tfor (let resultArrayCounter = 0; resultArrayCounter < data.length; resultArrayCounter++) {\n\t\t\t\tlet percentX = 0,\n\t\t\t\t\tpercentY = 0,\n\t\t\t\t\toffset = this.getOffset(this.maxDistance, data[resultArrayCounter].distance, resultArrayCounter),\n\t\t\t\t\toffsetX = offset[0],\n\t\t\t\t\toffsetY = offset[1],\n\t\t\t\t\trandomDirection = parseInt(Math.random() * 4 + 1, 10);\n\n\t\t\t\tpercentX = (offsetX / (this.width / 2)) * 100;\n\t\t\t\tpercentY = (offsetY / (this.height / 2)) * 100;\n\t\t\t\tdata[resultArrayCounter].percentX = percentX;\n\t\t\t\tdata[resultArrayCounter].percentY = percentY;\n\t\t\t\tdata[resultArrayCounter].randomDirection = randomDirection;\n\t\t\t\tresultArray.push(data[resultArrayCounter]);\n\t\t\t}\n\t\t\treturn resultArray;\n\t\t};\n\t}\n\tdrawRadar () {\n\t\tif (document.getElementById('forRadar')) {\n\t\t\t/*\n\t\t\t * delete existing canvases\n\t\t\t */\n\t\t\tdocument.getElementById('forRadar').innerHTML = '';\n\n\t\t\tif (document.getElementById('forRadar').children.length > 0) {\n\t\t\t\tdocument.getElementById('forRadar').children[0].remove();\n\t\t\t}\n\n\t\t\tconsole.log('this.width : ', this.width, ' this.height ', this.height);\n\t\t\tlet radius = 10,\n\t\t\t\tradarRingCounter = 0,\n\t\t\t\tminRadiusFor5Rings = parseInt(this.width, 10) / 1.2 / 5;\n\n\t\t\tthis.canvas.setAttribute('width', this.width);\n\t\t\tthis.canvas.setAttribute('height', this.height);\n\t\t\tthis.canvas.setAttribute('style', 'position: absolute; x:0; y:0;');\n\n\t\t\tdocument.getElementById('forRadar').appendChild(this.canvas);\n\n\t\t\tthis.context.clearRect(0, 0, this.width, this.height);\n\n\t\t\tthis.context.beginPath();\n\t\t\tthis.context.arc(this.centerX, this.centerY, radius, 0, 2 * Math.PI, false);\n\t\t\tthis.context.fillStyle = '#000';\n\t\t\tthis.context.fill();\n\t\t\tthis.context.stroke();\n\n\t\t\tfor (radarRingCounter = 0; radarRingCounter < 5; radarRingCounter++) {\n\t\t\t\tthis.context.beginPath();\n\t\t\t\tthis.context.arc(this.centerX, this.centerY, minRadiusFor5Rings * radarRingCounter, 0, 2 * Math.PI, false);\n\t\t\t\tif (radarRingCounter < 4) {\n\t\t\t\t\tthis.context.fill();\n\t\t\t\t\tthis.context.fillStyle = '#8bc717';\n\t\t\t\t\tthis.context.globalAlpha = parseFloat(radarRingCounter / 10) - 0.1;\n\t\t\t\t}\n\t\t\t\tthis.context.stroke();\n\t\t\t}\n\n\t\t\tthis.canvas.onclick = (e) => {\n\n\t\t\t\tvar thisX = parseInt(e.clientX, 10),\n\t\t\t\t\tthisY = parseInt(e.clientY, 10);\n\n\t\t\t\tfor (let i = 0; i < this.searchResults.length; i++) {\n\t\t\t\t\t/*\n\t\t\t\t\t * check if any of the people in the array have the coordinates clicked\n\t\t\t\t\t * (+/- 5px as this is the radius)\n\t\t\t\t\t * AND\n\t\t\t\t\t *  --- substract 60 px because of header !!! ---> 0 at the moment\n\t\t\t\t\t * (look above : we substracted 120px from total height)\n\t\t\t\t\t */\n\n\t\t\t\t\tif (\n\t\t\t\t\t\t((parseInt(this.searchResults[i].x) + parseInt(this.svgWidth)) >= thisX && this.searchResults[i].x <= thisX) &&\n\t\t\t\t\t\t((parseInt(this.searchResults[i].y) + parseInt(this.svgWidth)) >= (thisY - 60) && this.searchResults[i].y <= thisY - 60)\n\t\t\t\t\t) {\n\t\t\t\t\t\t//currentProfileIndex=i;\n\t\t\t\t\t\tconsole.log('User ', i);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t};\n\n\t\t\treturn true;\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t}\n\tdrawUsers (hasReturned) {\n\t\tvar done = false;\n\t\tfor (let resultArrayCounter = 0; resultArrayCounter < this.searchResults.length; resultArrayCounter++) {\n\t\t\t/*\n\t\t\t * hasReturned === true ; if the data is already existing\n\t\t\t * hasReturned === false; if the data needs to be set\n\t\t\t */\n\t\t\tif (!hasReturned) {\n\t\t\t\tvar newX,\n\t\t\t\t\tnewY,\n\t\t\t\t\tforX = ((this.maxDistance / parseInt(this.selectedDistance, 10)) * this.searchResults[resultArrayCounter].percentX),\n\t\t\t\t\tforY = ((this.maxDistance / parseInt(this.selectedDistance, 10)) * this.searchResults[resultArrayCounter].percentY),\n\t\t\t\t\toffsetX = forX, // (forX * 100) / (width / 2), //apply the percent to half the width (x)\n\t\t\t\t\toffsetY = forY, //(forY * 100) / (height / 2), //apply the percent to half the height (x)\n\t\t\t\t\trandomDirection = this.searchResults[resultArrayCounter].randomDirection;\n\t\t\t\t/*\n\t\t\t\t * show only results with 100% or less (if magnified)\n\t\t\t\t */\n\t\t\t\tif (parseInt(offsetX / 2, 10) <= 100 && parseInt(offsetY / 2, 10) <= 100) {\n\t\t\t\t\tswitch (randomDirection) {\n\t\t\t\t\t\tcase 1:\n\t\t\t\t\t\t\tnewX = parseInt(this.centerX + offsetX, 10);\n\t\t\t\t\t\t\tnewY = parseInt(this.centerY + offsetY, 10);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 2:\n\t\t\t\t\t\t\tnewX = parseInt(this.centerX - offsetX, 10);\n\t\t\t\t\t\t\tnewY = parseInt(this.centerY - offsetY, 10);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 3:\n\t\t\t\t\t\t\tnewX = parseInt(this.centerX + offsetX, 10);\n\t\t\t\t\t\t\tnewY = parseInt(this.centerY - offsetY, 10);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase 4:\n\t\t\t\t\t\t\tnewX = parseInt(this.centerX - offsetX, 10);\n\t\t\t\t\t\t\tnewY = parseInt(this.centerY + offsetY, 10);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tnewX = parseInt(this.centerX + 0, 10);\n\t\t\t\t\t\t\tnewY = parseInt(this.centerY + 0, 10);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\t/*\n\t\t\t\t\t * -> resultArray.push coordinates\n\t\t\t\t\t */\n\t\t\t\t\tthis.searchResults[resultArrayCounter].x = newX;\n\t\t\t\t\tthis.searchResults[resultArrayCounter].y = newY;\n\t\t\t\t\tthis.drawImage(this.searchResults[resultArrayCounter].x, this.searchResults[resultArrayCounter].y);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.drawImage(this.searchResults[resultArrayCounter].x, this.this.searchResults[resultArrayCounter].y);\n\t\t\t}\n\t\t\tif (parseInt(resultArrayCounter) + 1 === this.searchResults.length) {\n\t\t\t\tdone = true;\n\t\t\t}\n\t\t}\n\t\treturn done;\n\t}\n}\n\nSearchController.$inject = ['$rootScope', '$timeout', 'svgIcon', '$location', 'defaultDistance', 'maxDistance', 'languageSettings', 'ActivitiesService', 'LanguageService', 'DataService', 'AlertService', 'PositionService'];\n\nexport { SearchController };\n"],"sourceRoot":"/source/"}